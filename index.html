<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BNI Realizeãƒãƒ£ãƒ—ã‚¿ãƒ¼ ãƒ“ã‚¸ã‚¿ãƒ¼ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆå®Œå…¨ç‰ˆï¼‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Hiragino Sans', 'Meiryo', sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%);
            color: white;
            padding: 30px;
            text-align: center;
            border-radius: 10px 10px 0 0;
            margin: 0 auto;
            max-width: 1400px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 0 0 10px 10px;
        }
        
        .selector-section {
            background-color: #e3f2fd;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 1px solid #90caf9;
        }
        
        .selector-section h2 {
            color: #1565c0;
            margin-bottom: 15px;
            font-size: 20px;
        }
        
        .introducer-select {
            width: 100%;
            max-width: 500px;
            padding: 12px;
            font-size: 16px;
            border: 2px solid #1976d2;
            border-radius: 5px;
            background-color: white;
            cursor: pointer;
        }
        
        .stats-summary {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff9c4;
            border-radius: 5px;
            display: none;
        }
        
        .stats-summary strong {
            color: #f57f17;
        }
        
        .visitors-section {
            display: none;
            margin-top: 30px;
        }
        
        .visitors-section h3 {
            color: #424242;
            margin-bottom: 20px;
            font-size: 22px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
        }
        
        .visitor-card {
            background-color: #fafafa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        .visitor-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .visitor-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .visitor-name {
            font-size: 18px;
            font-weight: bold;
            color: #1976d2;
        }
        
        .interest-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
        }
        
        .interest-high {
            background-color: #ffebee;
            color: #c62828;
            border: 1px solid #ef5350;
        }
        
        .interest-medium {
            background-color: #fff3e0;
            color: #e65100;
            border: 1px solid #ff9800;
        }
        
        .interest-low {
            background-color: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #66bb6a;
        }
        
        .visitor-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .detail-item {
            font-size: 14px;
            color: #616161;
        }
        
        .detail-label {
            font-weight: bold;
            color: #424242;
        }
        
        .message-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .message-button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .regular-button {
            background-color: #1976d2;
            color: white;
        }
        
        .regular-button:hover {
            background-color: #0d47a1;
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .bod-button {
            background-color: #f57c00;
            color: white;
        }
        
        .bod-button:hover {
            background-color: #e65100;
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .message-display {
            display: none;
            margin-top: 20px;
            background-color: #f0f7ff;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #bbdefb;
            position: relative;
        }
        
        .message-display.show {
            display: block;
        }
        
        .message-type-label {
            font-weight: bold;
            color: #1565c0;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .message-text {
            white-space: pre-wrap;
            line-height: 1.8;
            color: #333;
            font-size: 14px;
            padding-right: 100px;
        }
        
        .copy-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: #4caf50;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .copy-button:hover {
            background-color: #45a049;
        }
        
        .copy-button.copied {
            background-color: #2196f3;
        }
        
        .no-visitors {
            text-align: center;
            padding: 40px;
            color: #757575;
            font-size: 16px;
        }
        
        .instructions {
            background-color: #fff9c4;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            border-left: 5px solid #f9a825;
        }
        
        .instructions h4 {
            color: #f57f17;
            margin-bottom: 10px;
        }
        
        .instructions ol {
            margin-left: 20px;
            color: #616161;
        }
        
        .instructions li {
            margin: 5px 0;
            line-height: 1.6;
        }
        
        .data-info {
            background-color: #e8f5e9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
            border: 1px solid #4caf50;
            text-align: center;
            color: #2e7d32;
        }
        
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>
<body>
    <div class="header">
        <h1>BNI Realizeãƒãƒ£ãƒ—ã‚¿ãƒ¼</h1>
        <p>ãƒ“ã‚¸ã‚¿ãƒ¼ç®¡ç†ãƒ»å†è¨ªå•ä¿ƒé€²ã‚·ã‚¹ãƒ†ãƒ ï¼ˆå®Œå…¨ç‰ˆï¼‰</p>
    </div>
    
    <div class="container">
        <div class="instructions">
            <h4>ğŸ“‹ ä½¿ã„æ–¹</h4>
            <ol>
                <li>ç´¹ä»‹è€…åã‚’é¸æŠã™ã‚‹ã¨ã€éå»ã«ç´¹ä»‹ã—ãŸãƒ“ã‚¸ã‚¿ãƒ¼ãŒä¸€è¦§è¡¨ç¤ºã•ã‚Œã¾ã™</li>
                <li>å„ãƒ“ã‚¸ã‚¿ãƒ¼ã®ç¢ºåº¦ã€å‚åŠ æ—¥ã€è©³ç´°æƒ…å ±ã‚’ç¢ºèªã§ãã¾ã™</li>
                <li>ã€Œé€šå¸¸å†å‚åŠ ä¾é ¼ã€ã¾ãŸã¯ã€Œãƒ“ã‚¸ãƒã‚¹ã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ã‚¤æ‹›å¾…ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                <li>è¡¨ç¤ºã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦LINEã§é€ä¿¡ã—ã¦ãã ã•ã„</li>
            </ol>
        </div>
        
        <div class="data-info" id="dataInfo">
            ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ä¸­...
        </div>
        
        <div class="selector-section" id="selectorSection">
            <h2>ğŸ‘¤ ç´¹ä»‹è€…ã‚’é¸æŠã—ã¦ãã ã•ã„</h2>
            <select class="introducer-select" id="introducerSelect" onchange="showVisitors()">
                <option value="">-- ç´¹ä»‹è€…ã‚’é¸æŠ --</option>
            </select>
            
            <div class="stats-summary" id="statsSummary"></div>
        </div>
        
        <div class="visitors-section" id="visitorsSection">
            <h3>ğŸ“Š ãƒ“ã‚¸ã‚¿ãƒ¼ä¸€è¦§</h3>
            <div id="visitorsList"></div>
        </div>
    </div>
    
    <script>
        // ãƒ‡ãƒ¼ã‚¿æ ¼ç´ç”¨å¤‰æ•°
        let visitorsData = {};
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«è‡ªå‹•çš„ã«CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€
        window.addEventListener('DOMContentLoaded', function() {
            fetch('visitor.csv')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('CSVãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
                    }
                    return response.text();
                })
                .then(csvText => {
                    Papa.parse(csvText, {
                        header: true,
                        skipEmptyLines: true,
                        complete: function(results) {
                            processCSVData(results.data);
                        },
                        error: function(error) {
                            console.error('CSVè§£æã‚¨ãƒ©ãƒ¼:', error);
                            document.getElementById('dataInfo').innerHTML = 
                                '<span style="color: #d32f2f;">CSVãƒ•ã‚¡ã‚¤ãƒ«ã®è§£æã«å¤±æ•—ã—ã¾ã—ãŸ</span>';
                        }
                    });
                })
                .catch(error => {
                    console.error('ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
                    document.getElementById('dataInfo').innerHTML = 
                        '<span style="color: #d32f2f;">visitor.csvãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„ã€‚</span>';
                });
        });
        
        // CSVãƒ‡ãƒ¼ã‚¿å‡¦ç†é–¢æ•°
        function processCSVData(data) {
            visitorsData = {};
            const introducerSelect = document.getElementById('introducerSelect');
            const selectorSection = document.getElementById('selectorSection');
            
            // æ—¢å­˜ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚¯ãƒªã‚¢ï¼ˆæœ€åˆã®ã€Œé¸æŠã—ã¦ãã ã•ã„ã€ä»¥å¤–ï¼‰
            while (introducerSelect.options.length > 1) {
                introducerSelect.remove(1);
            }
            
            // ãƒ‡ãƒ¼ã‚¿ã‚’ç´¹ä»‹è€…ã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
            data.forEach(row => {
                const introducerName = row['ç´¹ä»‹è€…'];
                
                if (!introducerName || introducerName === '') return;
                
                if (!visitorsData[introducerName]) {
                    visitorsData[introducerName] = {
                        name: introducerName,
                        visitors: []
                    };
                }
                
                // ãƒ“ã‚¸ã‚¿ãƒ¼æƒ…å ±ã‚’è¿½åŠ 
                visitorsData[introducerName].visitors.push({
                    name: row['å‚åŠ è€…ã®ãŠåå‰ï¼ˆæ¼¢å­—ï¼‰'] || '',
                    kana: row['å‚åŠ è€…ã®ãŠåå‰ï¼ˆã²ã‚‰ãŒãªï¼‰'] || '',
                    company: row['å‚åŠ è€…ã®ä¼šç¤¾åï¼ˆæ­£å¼åï¼‰'] || '',
                    field: row['å‚åŠ è€…ã®å°‚é–€åˆ†é‡'] || '',
                    interest: convertInterestLevel(row['ç¢ºåº¦ï¼ˆé–¢å¿ƒåº¦ï¼‰']),
                    interestOriginal: row['ç¢ºåº¦ï¼ˆé–¢å¿ƒåº¦ï¼‰'] || '',
                    visitDate: formatDate(row['å‚åŠ è€…ã®å‚åŠ äºˆå®šæ—¥']),
                    connections: row['ç¹‹ãŒã‚ŠãŸã„äººè„ˆ(ç«¯çš„ã«)'] || '',
                    email: row['ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹'] || '',
                    pr: row['PRæ–‡ï¼ˆäº‹æ¥­å†…å®¹ã€å¼·ã¿ï¼‰100æ–‡å­—ä»¥å†…'] || '',
                    category: row['å‚åŠ è€…ã®ã‚«ãƒ†ã‚´ãƒªï¼ˆè¿‘ã—ã„ã‚‚ã®ã‚’é¸æŠï¼‰'] || ''
                });
            });
            
            // ç´¹ä»‹è€…ã‚’ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã«è¿½åŠ ï¼ˆãƒ“ã‚¸ã‚¿ãƒ¼æ•°ã§ã‚½ãƒ¼ãƒˆï¼‰
            const sortedIntroducers = Object.entries(visitorsData)
                .sort((a, b) => b[1].visitors.length - a[1].visitors.length);
            
            sortedIntroducers.forEach(([key, data]) => {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = `${data.name} (${data.visitors.length}å)`;
                introducerSelect.appendChild(option);
            });
            
            // çµ±è¨ˆæƒ…å ±ã‚’æ›´æ–°
            const totalIntroducers = Object.keys(visitorsData).length;
            const totalVisitors = data.length;
            document.getElementById('dataInfo').innerHTML = 
                `<strong>ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿æ¸ˆã¿ï¼š</strong>ç´¹ä»‹è€… ${totalIntroducers}åã€ãƒ“ã‚¸ã‚¿ãƒ¼ ${totalVisitors}å`;
            
        }
        
        // ç¢ºåº¦ãƒ¬ãƒ™ãƒ«ã®å¤‰æ›
        function convertInterestLevel(interest) {
            if (!interest) return 'low';
            const upperInterest = interest.toUpperCase();
            if (upperInterest.includes('Aï¼šBNI') || upperInterest === 'A' || upperInterest === 'é«˜') {
                return 'high';
            } else if (upperInterest.includes('Bï¼šèˆˆå‘³') || upperInterest === 'B' || upperInterest === 'ä¸­') {
                return 'medium';
            }
            return 'low';
        }
        
        // æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        function formatDate(dateStr) {
            if (!dateStr) return 'æ—¥ä»˜ä¸æ˜';
            
            // æ—¢ã«å¹´ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã¯ãã®ã¾ã¾è¿”ã™
            if (dateStr.includes('å¹´')) return dateStr;
            
            // 2021/10/22 å½¢å¼ã‚’å¤‰æ›
            const slashMatch = dateStr.match(/(\d{4})\/(\d{1,2})\/(\d{1,2})/);
            if (slashMatch) {
                const year = slashMatch[1];
                const month = parseInt(slashMatch[2]);
                const day = parseInt(slashMatch[3]);
                return `${year}å¹´${month}æœˆ${day}æ—¥`;
            }
            
            // æœˆæ—¥ã®ã¿ã®å ´åˆã€å¹´ã‚’æ¨å®š
            const match = dateStr.match(/(\d+)æœˆ(\d+)æ—¥/);
            if (match) {
                const month = parseInt(match[1]);
                const day = parseInt(match[2]);
                const year = month >= 7 ? 2024 : 2025;
                return `${year}å¹´${month}æœˆ${day}æ—¥`;
            }
            
            return dateStr;
        }
        
        // å‚åŠ æ—¥ã‹ã‚‰çµŒéæœˆæ•°ã‚’è¨ˆç®—
        function getMonthsSinceVisit(visitDateStr) {
            if (!visitDateStr || visitDateStr === 'æ—¥ä»˜ä¸æ˜') return null;
            
            // æ—¥ä»˜ã‹ã‚‰å¹´æœˆæ—¥ã‚’æŠ½å‡º
            const yearMatch = visitDateStr.match(/(\d{4})å¹´(\d+)æœˆ(\d+)æ—¥/);
            const slashMatch = visitDateStr.match(/(\d{4})\/(\d{1,2})\/(\d{1,2})/);
            
            let visitDate;
            if (yearMatch) {
                visitDate = new Date(parseInt(yearMatch[1]), parseInt(yearMatch[2]) - 1, parseInt(yearMatch[3]));
            } else if (slashMatch) {
                visitDate = new Date(parseInt(slashMatch[1]), parseInt(slashMatch[2]) - 1, parseInt(slashMatch[3]));
            } else {
                return null;
            }
            
            const now = new Date();
            const monthsDiff = (now.getFullYear() - visitDate.getFullYear()) * 12 
                             + (now.getMonth() - visitDate.getMonth());
            
            return monthsDiff;
        }
        
        function showVisitors() {
            const select = document.getElementById('introducerSelect');
            const selectedValue = select.value;
            const visitorsSection = document.getElementById('visitorsSection');
            const statsSummary = document.getElementById('statsSummary');
            const visitorsList = document.getElementById('visitorsList');
            
            if (!selectedValue) {
                visitorsSection.style.display = 'none';
                statsSummary.style.display = 'none';
                return;
            }
            
            const data = visitorsData[selectedValue];
            if (!data || !data.visitors || data.visitors.length === 0) {
                visitorsSection.style.display = 'none';
                statsSummary.style.display = 'none';
                statsSummary.innerHTML = '<strong>ã“ã®ãƒ‡ãƒ¼ã‚¿ã«ã¯ãƒ“ã‚¸ã‚¿ãƒ¼ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</strong>';
                statsSummary.style.display = 'block';
                return;
            }
            
            // çµ±è¨ˆæƒ…å ±ã‚’è¡¨ç¤º
            const highCount = data.visitors.filter(v => v.interest === 'high').length;
            const mediumCount = data.visitors.filter(v => v.interest === 'medium').length;
            const lowCount = data.visitors.filter(v => v.interest === 'low').length;
            
            statsSummary.innerHTML = `
                <strong>ç´¹ä»‹å®Ÿç¸¾ï¼š</strong>åˆè¨ˆ ${data.visitors.length}å 
                ï¼ˆé«˜ç¢ºåº¦ï¼š${highCount}åã€ä¸­ç¢ºåº¦ï¼š${mediumCount}åã€ä½ç¢ºåº¦ï¼š${lowCount}åï¼‰
            `;
            statsSummary.style.display = 'block';
            
            // ãƒ“ã‚¸ã‚¿ãƒ¼ä¸€è¦§ã‚’è¡¨ç¤ºï¼ˆç¢ºåº¦ã®é«˜ã„é †ã«ã‚½ãƒ¼ãƒˆï¼‰
            const sortedVisitors = [...data.visitors].sort((a, b) => {
                const interestOrder = { 'high': 0, 'medium': 1, 'low': 2 };
                return interestOrder[a.interest] - interestOrder[b.interest];
            });
            
            visitorsList.innerHTML = '';
            sortedVisitors.forEach((visitor, index) => {
                const visitorCard = createVisitorCard(visitor, data.name, index);
                visitorsList.appendChild(visitorCard);
            });
            
            visitorsSection.style.display = 'block';
        }
        
        function createVisitorCard(visitor, introducerName, uniqueIndex) {
            const card = document.createElement('div');
            card.className = 'visitor-card';
            
            const interestClass = visitor.interest === 'high' ? 'interest-high' : 
                                visitor.interest === 'medium' ? 'interest-medium' : 'interest-low';
            const interestText = visitor.interestOriginal || 
                               (visitor.interest === 'high' ? 'é«˜' : 
                                visitor.interest === 'medium' ? 'ä¸­' : 'ä½');
            
            // PRæ–‡ã‚’çŸ­ç¸®è¡¨ç¤ºï¼ˆ100æ–‡å­—ä»¥ä¸Šã®å ´åˆï¼‰
            const prText = visitor.pr && visitor.pr.length > 100 
                         ? visitor.pr.substring(0, 100) + '...' 
                         : visitor.pr;
            
            card.innerHTML = `
                <div class="visitor-header">
                    <div class="visitor-name">${visitor.name || 'æ°åä¸æ˜'} æ§˜</div>
                    <span class="interest-badge ${interestClass}">ç¢ºåº¦ï¼š${interestText}</span>
                </div>
                <div class="visitor-details">
                    <div class="detail-item">
                        <span class="detail-label">ä¼šç¤¾åï¼š</span>${visitor.company || 'æœªè¨˜å…¥'}
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">å°‚é–€åˆ†é‡ï¼š</span>${visitor.field || 'æœªè¨˜å…¥'}
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">å‚åŠ æ—¥ï¼š</span>${visitor.visitDate || 'æ—¥ä»˜ä¸æ˜'}
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">ç¹‹ãŒã‚ŠãŸã„äººè„ˆï¼š</span>${visitor.connections || 'æœªè¨˜å…¥'}
                    </div>
                    ${visitor.pr ? `
                    <div class="detail-item" style="grid-column: 1 / -1;">
                        <span class="detail-label">PRæ–‡ï¼š</span>${prText}
                    </div>` : ''}
                    ${visitor.category ? `
                    <div class="detail-item">
                        <span class="detail-label">ã‚«ãƒ†ã‚´ãƒªï¼š</span>${visitor.category}
                    </div>` : ''}
                </div>
                <div class="message-buttons">
                    <button class="message-button regular-button" 
                            onclick="showMessage('${uniqueIndex}', 'regular', '${introducerName.replace(/'/g, "\\'")}')">
                        é€šå¸¸ã®ãƒ“ã‚¸ã‚¿ãƒ¼å†å‚åŠ ä¾é ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
                    </button>
                    <button class="message-button bod-button" 
                            onclick="showMessage('${uniqueIndex}', 'bod', '${introducerName.replace(/'/g, "\\'")}')">
                        ãƒ“ã‚¸ãƒã‚¹ã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ã‚¤æ‹›å¾…ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
                    </button>
                </div>
                <div class="message-display" id="message-${uniqueIndex}"></div>
            `;
            
            return card;
        }
        
        function showMessage(visitorIndex, messageType, introducerName) {
            const selectedValue = document.getElementById('introducerSelect').value;
            const data = visitorsData[selectedValue];
            
            // ãƒ“ã‚¸ã‚¿ãƒ¼ã‚’ç¢ºåº¦é †ã«ã‚½ãƒ¼ãƒˆï¼ˆè¡¨ç¤ºã¨åŒã˜é †åºï¼‰
            const sortedVisitors = [...data.visitors].sort((a, b) => {
                const interestOrder = { 'high': 0, 'medium': 1, 'low': 2 };
                return interestOrder[a.interest] - interestOrder[b.interest];
            });
            
            const visitor = sortedVisitors[visitorIndex];
            const messageDisplay = document.getElementById(`message-${visitorIndex}`);
            
            let message = '';
            let typeLabel = '';
            
            if (messageType === 'regular') {
                typeLabel = 'é€šå¸¸ã®å†å‚åŠ ä¾é ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸';
                message = generateRegularMessage(visitor, introducerName);
            } else {
                typeLabel = 'ãƒ“ã‚¸ãƒã‚¹ã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ã‚¤æ‹›å¾…ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸';
                message = generateBODMessage(visitor, introducerName);
            }
            
            messageDisplay.innerHTML = `
                <div class="message-type-label">${typeLabel}</div>
                <button class="copy-button" onclick="copyMessage(this)">ã‚³ãƒ”ãƒ¼</button>
                <div class="message-text">${message}</div>
            `;
            
            messageDisplay.classList.add('show');
        }
        
        function generateRegularMessage(visitor, introducerName) {
            // æ—¥ä»˜ã‹ã‚‰æœˆã‚’æŠ½å‡º
            const visitDateStr = visitor.visitDate || '';
            const monthMatch = visitDateStr.match(/(\d+)å¹´(\d+)æœˆ/) || visitDateStr.match(/(\d+)æœˆ/);
            const visitMonth = monthMatch 
                ? (monthMatch[2] ? `${monthMatch[2]}æœˆ` : `${monthMatch[1]}æœˆ`)
                : 'å…ˆæ—¥';
            
            const visitorName = visitor.name || 'ãƒ“ã‚¸ã‚¿ãƒ¼';
            const connections = visitor.connections || 'ãƒ“ã‚¸ãƒã‚¹ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼';
            const field = visitor.field || 'ãƒ“ã‚¸ãƒã‚¹';
            
            // çµŒéæœˆæ•°ã‚’ç¢ºèª
            const monthsSince = getMonthsSinceVisit(visitDateStr);
            
            // 3ãƒ¶æœˆä»¥ä¸ŠçµŒéã—ã¦ã„ã‚‹å ´åˆ
            if (monthsSince && monthsSince >= 3) {
                return `${visitorName}æ§˜

ã”ç„¡æ²™æ±°ã—ã¦ãŠã‚Šã¾ã™ã€‚
BNI Realizeãƒãƒ£ãƒ—ã‚¿ãƒ¼ã®${introducerName}ã§ã™ã€‚

${visitDateStr.match(/\d+å¹´\d+æœˆ/) ? visitDateStr.match(/(\d+å¹´\d+æœˆ)/)[1] : visitMonth}ã®å®šä¾‹ä¼šã«ã”å‚åŠ ã„ãŸã ãã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚

ã“ã®åº¦ã€å½“ãƒãƒ£ãƒ—ã‚¿ãƒ¼ã«æ–°ãŸãªå°‚é–€å®¶ãŒè¤‡æ•°åŠ ã‚ã‚Šã€
ä»¥å‰ã‚ˆã‚Šã‚‚å¤šå½©ãªæ¥­ç¨®ã¨ã®äº¤æµãŒæ´»ç™ºã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚

å‰å›ã¨ã¯ç•°ãªã‚‹ãƒ¡ãƒ³ãƒãƒ¼æ§‹æˆã¨ãªã£ã¦ãŠã‚Šã¾ã™ã®ã§ã€
æ–°ãŸãªã”ç¸ã‚„ãƒ“ã‚¸ãƒã‚¹ã®å¯èƒ½æ€§ã‚’æ„Ÿã˜ã¦ã„ãŸã ã‘ã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚

â–¼ ãƒ¡ãƒ³ãƒãƒ¼ãƒªã‚¹ãƒˆï¼ˆäº‹å‰ã«ã”ç¢ºèªãã ã•ã„ï¼‰
â€»æ°—ã«ãªã‚‹æ¥­ç¨®ã‚„ãŠç¹‹ãã—ãŸã„æ–¹ãŒã„ã‚Œã°ã€äº‹å‰ã«ã”é€£çµ¡ãã ã•ã„ã€‚å€‹åˆ¥ã«ã”ç´¹ä»‹ã‚‚å¯èƒ½ã§ã™ã€‚
https://drive.google.com/file/d/1ejRDmTGNeHSxRmw5Gv04xk_pGtRMtPKz/view?usp=drive_link

ã¾ãŸã€å½“æ—¥ã¯æ²¢å±±ã®ãƒ“ã‚¸ã‚¿ãƒ¼æ§˜ã‚‚å‚åŠ äºˆå®šã§ã™ã®ã§ã€
Realizeãƒãƒ£ãƒ—ã‚¿ãƒ¼ä»¥å¤–ã®æ–¹ã¨ã‚‚äº¤æµã„ãŸã ã‘ã‚‹è²´é‡ãªæ©Ÿä¼šã¨ãªã£ã¦ãŠã‚Šã¾ã™ã€‚

ã”éƒ½åˆã®è‰¯ã„é‡‘æ›œæ—¥ãŒã‚ã‚Šã¾ã—ãŸã‚‰ã€æ˜¯éã”å‚åŠ é ‚ã‘ã‚Œã°ã¨æ€ã†ã®ã§ã™ãŒã€
ã”éƒ½åˆã„ã‹ãŒã§ã—ã‚‡ã†ã‹ï¼Ÿ

${introducerName}`;
            }
            
            // 3ãƒ¶æœˆä»¥å†…ã®å ´åˆ
            else {
                return `${visitorName}æ§˜

ã”ç„¡æ²™æ±°ã—ã¦ãŠã‚Šã¾ã™ã€‚
BNI Realizeãƒãƒ£ãƒ—ã‚¿ãƒ¼ã®${introducerName}ã§ã™ã€‚

å…ˆæ—¥ã¯ã€BNI Realizeãƒãƒ£ãƒ—ã‚¿ãƒ¼ã®å®šä¾‹ä¼šã«ã”å‚åŠ ã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚

${field !== 'æœªè¨˜å…¥' && field ? `${field}ã¨ã—ã¦ã®ãŠè©±ã€å¤§å¤‰èˆˆå‘³æ·±ãã€ãƒ¡ãƒ³ãƒãƒ¼ã‹ã‚‰ã‚‚ã€Œãœã²ã€ã‚‚ã£ã¨è©³ã—ããŠè©±ã‚’ä¼ºã„ãŸã„ã€ã¨ã„ã†å£°ãŒä¸ŠãŒã£ã¦ãŠã‚Šã¾ã—ãŸã€‚` : ''}

å…ˆæ—¥ã®ä¾‹ä¼šä»¥é™ã‚‚ç§ãŸã¡ã®ãƒãƒ£ãƒ—ã‚¿ãƒ¼ã¯æ´»ç™ºã«å‹•ã„ã¦ãŠã‚Šã€æ–°ã—ã„å°‚é–€å®¶ã‚‚åŠ ã‚ã‚Šã¾ã—ãŸã€‚

å‰å›ã¨ã¯ã¾ãŸé•ã£ãŸæ–°ãŸãªã”ç¸ã‚„ãƒ“ã‚¸ãƒã‚¹ã®å¯èƒ½æ€§ã‚‚æ„Ÿã˜ã¦ã„ãŸã ã‘ã‚‹ã‹ã¨å­˜ã˜ã¾ã™ã€‚

â–¼ æœ€æ–°ã®ãƒ¡ãƒ³ãƒãƒ¼ãƒªã‚¹ãƒˆï¼ˆã‚ˆã‚ã—ã‘ã‚Œã°ã€ã”ç¢ºèªãã ã•ã„ï¼‰

â€»å‰å›ãŠè©±ã—ã—ã¦ã¿ã¦æ°—ã«ãªã£ãŸæ–¹ã‚„ã€æ–°ãŸã«ã”èˆˆå‘³ã®ã‚ã‚‹æ–¹ãŒã„ã‚‰ã£ã—ã‚ƒã„ã¾ã—ãŸã‚‰ã€ãœã²äº‹å‰ã«ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚å€‹åˆ¥ã«ã”ç´¹ä»‹ã‚‚å¯èƒ½ã§ã™ã€‚

https://drive.google.com/file/d/1ejRDmTGNeHSxRmw5Gv04xk_pGtRMtPKz/view?usp=drive_link

ã¾ãŸã€å½“æ—¥ã¯ä»–ã«ã‚‚å¤šãã®ãƒ“ã‚¸ã‚¿ãƒ¼æ§˜ãŒå‚åŠ ã•ã‚Œã‚‹äºˆå®šã§ã™ã€‚

ãƒ¡ãƒ³ãƒãƒ¼ä»¥å¤–ã®æ–¹ã¨ã‚‚äº¤æµã„ãŸã ã‘ã‚‹è²´é‡ãªæ©Ÿä¼šã¨ãªã£ã¦ãŠã‚Šã¾ã™ã®ã§ã€ãœã²ã”æ´»ç”¨ãã ã•ã„ã€‚

ã”éƒ½åˆã®è‰¯ã„é‡‘æ›œæ—¥ãŒã‚ã‚Šã¾ã—ãŸã‚‰ã€æ˜¯éã”å‚åŠ é ‚ã‘ã‚Œã°ã¨æ€ã†ã®ã§ã™ãŒã€
ã”éƒ½åˆã„ã‹ãŒã§ã—ã‚‡ã†ã‹ï¼Ÿ

${introducerName}`;
            }
        }
        
        function generateBODMessage(visitor, introducerName) {
            // æ—¥ä»˜ã‹ã‚‰æœˆã‚’æŠ½å‡º
            const visitDateStr = visitor.visitDate || '';
            const monthMatch = visitDateStr.match(/(\d+)å¹´(\d+)æœˆ/) || visitDateStr.match(/(\d+)æœˆ/);
            const visitMonth = monthMatch 
                ? (monthMatch[2] ? `${monthMatch[2]}æœˆ` : `${monthMatch[1]}æœˆ`)
                : 'å…ˆæ—¥';
            
            const visitorName = visitor.name || 'ãƒ“ã‚¸ã‚¿ãƒ¼';
            const connections = visitor.connections || 'ãƒ“ã‚¸ãƒã‚¹ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼';
            const field = visitor.field || 'ãƒ“ã‚¸ãƒã‚¹';
            
            // çµŒéæœˆæ•°ã‚’ç¢ºèª
            const monthsSince = getMonthsSinceVisit(visitDateStr);
            
            // 3ãƒ¶æœˆä»¥ä¸ŠçµŒéã—ã¦ã„ã‚‹å ´åˆ
            if (monthsSince && monthsSince >= 3) {
                return `${visitorName}æ§˜

ã”ç„¡æ²™æ±°ã—ã¦ãŠã‚Šã¾ã™ã€‚
BNI Realizeãƒãƒ£ãƒ—ã‚¿ãƒ¼ã®${introducerName}ã§ã™ã€‚

${visitDateStr.match(/\d+å¹´\d+æœˆ/) ? visitDateStr.match(/(\d+å¹´\d+æœˆ)/)[1] : visitMonth}ã«ãŠä¼šã„ã—ã¦ã‹ã‚‰ã—ã°ã‚‰ãçµŒã¡ã¾ã™ãŒã€
ãã®å¾Œã‚‚ã”æ´»èºã®ã“ã¨ã¨å­˜ã˜ã¾ã™ã€‚

ã“ã®åº¦ã€2025å¹´7æœˆ25æ—¥ï¼ˆé‡‘ï¼‰ã«ç‰¹åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ
ã€ŒBusiness Open Dayã€ã‚’é–‹å‚¬ã„ãŸã—ã¾ã™ï¼

é€šå¸¸ã‚ˆã‚Šã‚‚ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ãªé›°å›²æ°—ã§ã€
Realizeãƒ¡ãƒ³ãƒãƒ¼ã¨å¤šããƒ“ã‚¸ã‚¿ãƒ¼æ§˜ãŒä¸€å ‚ã«é›†ã†ã€
å¹´ã«æ•°å›ã®ç‰¹åˆ¥ãªã‚ªãƒ¼ãƒ—ãƒ³äº¤æµä¼šã§ã™ã€‚

å½“æ—¥ã¯å‚åŠ è€…é–“ã®äº¤æµã®æ™‚é–“ã‚‚é€šå¸¸ã®å®šä¾‹ä¼šã‚ˆã‚Šã‚‚æ²¢å±±ã”ç”¨æ„ã•ã›ã¦é ‚ãã¾ã™ã€‚
${field !== 'æœªè¨˜å…¥' && field ? `${field}ã®åˆ†é‡ã§ã”æ´»èºã®${visitorName}æ§˜ã«ã¨ã£ã¦ã‚‚
ã€Œæ–°ãŸãªå‡ºä¼šã„ã‚„æ¡ˆä»¶ã®ãã£ã‹ã‘ã«ãªã‚‹å ´ã€ã«ãªã‚‹ã‹ã¨ç¢ºä¿¡ã—ã¦ã„ã¾ã™ã€‚` : `ã€Œæ–°ãŸãªå‡ºä¼šã„ã‚„æ¡ˆä»¶ã®ãã£ã‹ã‘ã«ãªã‚‹å ´ã€ã«ãªã‚‹ã‹ã¨ç¢ºä¿¡ã—ã¦ã„ã¾ã™ã€‚`}

å‰å›ã¨ã¯ç•°ãªã‚‹ãƒ¡ãƒ³ãƒãƒ¼æ§‹æˆã¨ãªã£ã¦ãŠã‚Šã¾ã™ã®ã§ã€
æ–°ãŸãªã”ç¸ã‚„ãƒ“ã‚¸ãƒã‚¹ã®å¯èƒ½æ€§ã‚’æ„Ÿã˜ã¦ã„ãŸã ã‘ã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚

â–¼ ãƒ¡ãƒ³ãƒãƒ¼ãƒªã‚¹ãƒˆï¼ˆäº‹å‰ã«ã”ç¢ºèªãã ã•ã„ï¼‰
â€»æ°—ã«ãªã‚‹æ¥­ç¨®ã‚„ãŠç¹‹ãã—ãŸã„æ–¹ãŒã„ã‚Œã°ã€äº‹å‰ã«ã”é€£çµ¡ãã ã•ã„ã€‚å€‹åˆ¥ã«ã”ç´¹ä»‹ã‚‚å¯èƒ½ã§ã™ã€‚
https://drive.google.com/file/d/1ejRDmTGNeHSxRmw5Gv04xk_pGtRMtPKz/view?usp=drive_link

ã¾ãŸã€å½“æ—¥ã¯æ²¢å±±ã®ãƒ“ã‚¸ã‚¿ãƒ¼æ§˜ã‚‚å‚åŠ äºˆå®šã§ã™ã®ã§ã€
Realizeãƒãƒ£ãƒ—ã‚¿ãƒ¼ä»¥å¤–ã®æ–¹ã¨ã‚‚äº¤æµã„ãŸã ã‘ã‚‹è²´é‡ãªæ©Ÿä¼šã¨ãªã£ã¦ãŠã‚Šã¾ã™ã€‚

ã”èˆˆå‘³ã®ã‚ã‚‹æ¥­ç¨®ã‚„ç¹‹ãŒã‚ŠãŸã„æ–¹ãŒã„ã‚Œã°ã€ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚
ç§ã‹ã‚‰è²¬ä»»ã‚’ã‚‚ã£ã¦ãŠç¹‹ãã„ãŸã—ã¾ã™ã€‚

ã”é–¢å¿ƒã‚’ãŠæŒã¡ã„ãŸã ã‘ã¾ã—ãŸã‚‰ã€
è©³ç´°ã‚’ãŠé€ã‚Šã—ã¾ã™ã®ã§ã€ãŠæ°—è»½ã«ã”é€£çµ¡ã„ãŸã ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ã€‚

7æœˆ25æ—¥(é‡‘)ã®æœã®ã”éƒ½åˆã„ã‹ãŒã§ã—ã‚‡ã†ã‹ï¼Ÿ

${introducerName}`;
            }
            
            // 3ãƒ¶æœˆä»¥å†…ã®å ´åˆ
            else {
                return `${visitorName}æ§˜

ã”ç„¡æ²™æ±°ã—ã¦ãŠã‚Šã¾ã™ã€‚
BNI Realizeãƒãƒ£ãƒ—ã‚¿ãƒ¼ã®${introducerName}ã§ã™ã€‚

å…ˆæ—¥ã¯ã€BNIã€REALIZEãƒãƒ£ãƒ—ã‚¿ãƒ¼å®šä¾‹ä¼šã«ã”å‚åŠ é ‚ãã¾ã—ã¦ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚

ã“ã®åº¦ã€2025å¹´7æœˆ25æ—¥ï¼ˆé‡‘ï¼‰ã«ç‰¹åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ
ã€ŒBusiness Open Dayã€ã‚’é–‹å‚¬ã™ã‚‹ã“ã¨ã¨ãªã‚Šã¾ã—ãŸï¼

å®šä¾‹ä¼šã¨ã¯ã¾ãŸé•ã£ãŸé›°å›²æ°—ã§ãƒ¡ãƒ³ãƒãƒ¼ã‚„ä»–ã®ãƒ“ã‚¸ã‚¿ãƒ¼æ§˜ã¨ç¹‹ãŒã‚Œã‚‹ç‰¹åˆ¥ãªã‚¤ãƒ™ãƒ³ãƒˆã«ãªã‚Šã¾ã™ã®ã§æ˜¯éã”å‚åŠ é ‚ãã“ã¨ã§ã€ ${visitorName}æ§˜ã®ãƒ“ã‚¸ãƒã‚¹ã®ç™ºå±•ã«ç¹‹ãŒã‚‹è‰¯ã„æ©Ÿä¼šã«ãªã‚‹ã¨æ€ã„ã”é€£çµ¡ã•ã›ã¦é ‚ãã¾ã—ãŸã€‚

é€šå¸¸ã‚ˆã‚Šã‚‚ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ãªé›°å›²æ°—ã§ã€
Realizeãƒ¡ãƒ³ãƒãƒ¼ã¨å¤šããƒ“ã‚¸ã‚¿ãƒ¼æ§˜ãŒä¸€å ‚ã«é›†ã†ã€
å¹´ã«æ•°å›ã®ç‰¹åˆ¥ãªã‚ªãƒ¼ãƒ—ãƒ³äº¤æµä¼šã§ã™ã€‚

å½“æ—¥ã¯å‚åŠ è€…é–“ã®äº¤æµã®æ™‚é–“ã‚‚é€šå¸¸ã®å®šä¾‹ä¼šã‚ˆã‚Šã‚‚æ²¢å±±ã”ç”¨æ„ã•ã›ã¦é ‚ãã¾ã™ã€‚
${field !== 'æœªè¨˜å…¥' && field ? `${field}ã®åˆ†é‡ã§ã”æ´»èºã®${visitorName}æ§˜ã«ã¨ã£ã¦ã‚‚
ã€Œæ–°ãŸãªå‡ºä¼šã„ã‚„æ¡ˆä»¶ã®ãã£ã‹ã‘ã«ãªã‚‹å ´ã€ã«ãªã‚‹ã‹ã¨ç¢ºä¿¡ã—ã¦ã„ã¾ã™ã€‚` : `ã€Œæ–°ãŸãªå‡ºä¼šã„ã‚„æ¡ˆä»¶ã®ãã£ã‹ã‘ã«ãªã‚‹å ´ã€ã«ãªã‚‹ã‹ã¨ç¢ºä¿¡ã—ã¦ã„ã¾ã™ã€‚`}

å‰å›ã¨ã¯ç•°ãªã‚‹ãƒ¡ãƒ³ãƒãƒ¼æ§‹æˆã¨ãªã£ã¦ãŠã‚Šã¾ã™ã®ã§ã€
æ–°ãŸãªã”ç¸ã‚„ãƒ“ã‚¸ãƒã‚¹ã®å¯èƒ½æ€§ã‚’æ„Ÿã˜ã¦ã„ãŸã ã‘ã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚

â–¼ ãƒ¡ãƒ³ãƒãƒ¼ãƒªã‚¹ãƒˆï¼ˆäº‹å‰ã«ã”ç¢ºèªãã ã•ã„ï¼‰
â€»æ°—ã«ãªã‚‹æ¥­ç¨®ã‚„ãŠç¹‹ãã—ãŸã„æ–¹ãŒã„ã‚Œã°ã€äº‹å‰ã«ã”é€£çµ¡ãã ã•ã„ã€‚å€‹åˆ¥ã«ã”ç´¹ä»‹ã‚‚å¯èƒ½ã§ã™ã€‚
https://drive.google.com/file/d/1ejRDmTGNeHSxRmw5Gv04xk_pGtRMtPKz/view?usp=drive_link

ã¾ãŸã€å½“æ—¥ã¯æ²¢å±±ã®ãƒ“ã‚¸ã‚¿ãƒ¼æ§˜ã‚‚å‚åŠ äºˆå®šã§ã™ã®ã§ã€
Realizeãƒãƒ£ãƒ—ã‚¿ãƒ¼ä»¥å¤–ã®æ–¹ã¨ã‚‚äº¤æµã„ãŸã ã‘ã‚‹è²´é‡ãªæ©Ÿä¼šã¨ãªã£ã¦ãŠã‚Šã¾ã™ã€‚

ã”èˆˆå‘³ã®ã‚ã‚‹æ¥­ç¨®ã‚„ç¹‹ãŒã‚ŠãŸã„æ–¹ãŒã„ã‚Œã°ã€ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚
ç§ã‹ã‚‰è²¬ä»»ã‚’ã‚‚ã£ã¦ãŠç¹‹ãã„ãŸã—ã¾ã™ã€‚

ã”é–¢å¿ƒã‚’ãŠæŒã¡ã„ãŸã ã‘ã¾ã—ãŸã‚‰ã€
è©³ç´°ã‚’ãŠé€ã‚Šã—ã¾ã™ã®ã§ã€ãŠæ°—è»½ã«ã”é€£çµ¡ã„ãŸã ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ã€‚

7æœˆ25æ—¥(é‡‘)ã®æœã®ã”éƒ½åˆã„ã‹ãŒã§ã—ã‚‡ã†ã‹ï¼Ÿ

${introducerName}`;
            }
        }
        
        function copyMessage(button) {
            const messageText = button.parentElement.querySelector('.message-text').textContent;
            
            navigator.clipboard.writeText(messageText).then(() => {
                const originalText = button.textContent;
                button.textContent = 'ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼';
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
                const textArea = document.createElement('textarea');
                textArea.value = messageText;
                textArea.style.position = 'fixed';
                textArea.style.opacity = '0';
                document.body.appendChild(textArea);
                textArea.select();
                
                try {
                    document.execCommand('copy');
                    button.textContent = 'ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼';
                    button.classList.add('copied');
                    
                    setTimeout(() => {
                        button.textContent = 'ã‚³ãƒ”ãƒ¼';
                        button.classList.remove('copied');
                    }, 2000);
                } catch (err) {
                    console.error('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ:', err);
                }
                
                document.body.removeChild(textArea);
            });
        }
    </script>
</body>
</html>